<!doctype html>
<html lang="de">
<head><meta charset="utf-8"><title>Galerie</title></head>
<body>
<h1>Private Galerie</h1>
<div id="grid"></div>

<script>
// Beispiel-Liste von Photo-IDs aus Proton Drive
const photos = [
{ id: 'FILE_ID_1', name: 'Bild 1' },
{ id: 'FILE_ID_2', name: 'Bild 2' }
];

async function fetchImage(id) {
const pw = sessionStorage.getItem('gallery_pw');
if (!pw) { alert('Bitte zuerst Passwort eingeben.'); window.location.href = 'password.html'; return; }

const res = await fetch('/.netlify/functions/getPhoto?id=' + encodeURIComponent(id), {
headers: { 'x-gallery-password': pw }
});

if (!res.ok) { console.error('fetch failed', res.status); return null; }

const blob = await res.blob();
return URL.createObjectURL(blob);
}

(async () => {
const grid = document.getElementById('grid');
for (const p of photos) {
const src = await fetchImage(p.id);
if (!src) continue;
const img = document.createElement('img');
img.src = src;
img.alt = p.name;
img.style.width = '300px';
img.style.margin = '10px';
grid.appendChild(img);
}
})();
</script>
</body>
</html>
